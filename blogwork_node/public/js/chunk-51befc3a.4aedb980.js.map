{"version":3,"sources":["webpack:///./src/views/Information.vue?4913","webpack:///src/views/Information.vue","webpack:///./src/views/Information.vue?163a","webpack:///./src/views/Information.vue","webpack:///./src/views/Information.vue?6fb7"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","model","value","callback","$$v","activeName","expression","ref","ruleForm","rules","_s","userInfo","userName","$set","on","$event","handlerClick","ruleFormPass","rulesPass","inputType","submitForm","_id","handleAvatarSuccess","beforeAvatarUpload","imageUrl","staticRenderFns","name","data","Error","reg","test","originPass","newPass","resultPass","computed","$store","state","methods","$refs","formName","validate","URL","createObjectURL","file","raw","changeInfo","res","$message","success","isJPG","error","isLt2M","component"],"mappings":"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","file":"js/chunk-51befc3a.4aedb980.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h2',{staticClass:\"border_left\"},[_vm._v(\"修改资料\")]),_c('el-tabs',{attrs:{\"type\":\"card\"},model:{value:(_vm.activeName),callback:function ($$v) {_vm.activeName=$$v},expression:\"activeName\"}},[_c('el-tab-pane',{attrs:{\"label\":\"用户名\",\"name\":\"first\"}},[_c('el-form',{ref:\"ruleForm\",attrs:{\"model\":_vm.ruleForm,\"rules\":_vm.rules,\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"原用户名\"}},[_vm._v(_vm._s(_vm.userInfo.userName))]),_c('el-form-item',{attrs:{\"label\":\"新用户名\",\"prop\":\"userName\"}},[_c('el-input',{attrs:{\"type\":\"text\",\"autocomplete\":\"off\",\"size\":\"small\"},model:{value:(_vm.ruleForm.userName),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"userName\", $$v)},expression:\"ruleForm.userName\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.handlerClick('ruleForm')}}},[_vm._v(\"提交\")])],1)],1)],1),_c('el-tab-pane',{attrs:{\"label\":\"修改密码\",\"name\":\"second\"}},[_c('el-form',{ref:\"ruleFormPass\",attrs:{\"model\":_vm.ruleFormPass,\"rules\":_vm.rulesPass,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"原密码\",\"prop\":\"originPass\"}},[_c('el-input',{attrs:{\"type\":_vm.inputType,\"autocomplete\":\"off\"},model:{value:(_vm.ruleFormPass.originPass),callback:function ($$v) {_vm.$set(_vm.ruleFormPass, \"originPass\", $$v)},expression:\"ruleFormPass.originPass\"}})],1),_c('el-form-item',{attrs:{\"label\":\"新密码\",\"prop\":\"newPass\"}},[_c('el-input',{attrs:{\"type\":_vm.inputType,\"autocomplete\":\"off\"},model:{value:(_vm.ruleFormPass.newPass),callback:function ($$v) {_vm.$set(_vm.ruleFormPass, \"newPass\", $$v)},expression:\"ruleFormPass.newPass\"}})],1),_c('el-form-item',{attrs:{\"label\":\"确认密码\",\"prop\":\"resultPass\"}},[_c('el-input',{attrs:{\"type\":_vm.inputType,\"autocomplete\":\"off\"},model:{value:(_vm.ruleFormPass.resultPass),callback:function ($$v) {_vm.$set(_vm.ruleFormPass, \"resultPass\", $$v)},expression:\"ruleFormPass.resultPass\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('ruleFormPass')}}},[_vm._v(\"提交\")]),_c('el-button',{on:{\"click\":function($event){_vm.inputType = 'text'}}},[_vm._v(\"显示密码\")])],1)],1)],1),_c('el-tab-pane',{attrs:{\"label\":\"更换头像\",\"name\":\"third\"}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":\"/blog/changeimg\",\"data\":{'id':_vm.userInfo._id},\"show-file-list\":false,\"on-success\":_vm.handleAvatarSuccess,\"before-upload\":_vm.beforeAvatarUpload}},[(_vm.imageUrl)?_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.imageUrl}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <h2 class=\"border_left\">修改资料</h2>\r\n    <el-tabs v-model=\"activeName\" type=\"card\">\r\n      <!-- 修改用户名 -->\r\n      <el-tab-pane label=\"用户名\" name=\"first\">\r\n        <el-form\r\n          :model=\"ruleForm\"\r\n          :rules=\"rules\"\r\n          ref=\"ruleForm\"\r\n          label-width=\"80px\"\r\n        >\r\n          <el-form-item label=\"原用户名\">{{ userInfo.userName }}</el-form-item>\r\n          <el-form-item label=\"新用户名\" prop=\"userName\">\r\n            <el-input\r\n              type=\"text\"\r\n              v-model=\"ruleForm.userName\"\r\n              autocomplete=\"off\"\r\n              size=\"small\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button\r\n              type=\"primary\"\r\n              size=\"small\"\r\n              @click=\"handlerClick('ruleForm')\"\r\n              >提交</el-button\r\n            >\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-tab-pane>\r\n\r\n      <!-- 修改密码 -->\r\n      <el-tab-pane label=\"修改密码\" name=\"second\">\r\n        <el-form\r\n          :model=\"ruleFormPass\"\r\n          :rules=\"rulesPass\"\r\n          ref=\"ruleFormPass\"\r\n          label-width=\"100px\"\r\n        >\r\n          <el-form-item label=\"原密码\" prop=\"originPass\">\r\n            <el-input\r\n              :type=\"inputType\"\r\n              v-model=\"ruleFormPass.originPass\"\r\n              autocomplete=\"off\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"新密码\" prop=\"newPass\">\r\n            <el-input\r\n              :type=\"inputType\"\r\n              v-model=\"ruleFormPass.newPass\"\r\n              autocomplete=\"off\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"确认密码\" prop=\"resultPass\">\r\n            <el-input\r\n              :type=\"inputType\"\r\n              v-model=\"ruleFormPass.resultPass\"\r\n              autocomplete=\"off\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"submitForm('ruleFormPass')\"\r\n              >提交</el-button\r\n            >\r\n            <el-button @click=\"inputType = 'text'\">显示密码</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </el-tab-pane>\r\n\r\n      <!-- 更换头像 -->\r\n      <el-tab-pane label=\"更换头像\" name=\"third\">\r\n        <el-upload\r\n          class=\"avatar-uploader\"\r\n          action=\"/blog/changeimg\"\r\n          :data=\"{'id':userInfo._id}\"\r\n          :show-file-list=\"false\"\r\n          :on-success=\"handleAvatarSuccess\"\r\n          :before-upload=\"beforeAvatarUpload\"\r\n        >\r\n          <img v-if=\"imageUrl\" :src=\"imageUrl\" class=\"avatar\" />\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n      </el-tab-pane>\r\n    </el-tabs>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from \"vuex\";\r\nexport default {\r\n  name: \"Information\",\r\n  data() {\r\n    // 设置用户名\r\n    let validateuserName = (rule, value, callback) => {\r\n      let reg = /^[\\u4e00-\\u9fa5_\\w]{3,14}$/;\r\n      if (!value) {\r\n        return callback(new Error(\"用户名不能为空\"));\r\n      } else if (!reg.test(value)) {\r\n        callback(new Error(\"请求输入3-14个字符\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    // 设置密码\r\n    let validateoriginPass = (rule, value, callback) => {\r\n      if (!value) {\r\n        return callback(new Error(\"用户名不能为空\"));\r\n      } else if (value != this.userInfo.userPass) {\r\n        callback(new Error(\"原密码错误\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    let validatenewPass = (rule, value, callback) => {\r\n      let reg = /^[\\w_`~!@#$%^&*()+=-\\\\\\]\\]\\{\\}:;'\\,.<>/?]{6,15}$/;\r\n      if (value == \"\") return callback(new Error(\"密码不能为空！\"));\r\n      if (!reg.test(value))\r\n        return callback(new Error(\"输入6~15个字符，不能是中文\"));\r\n      callback();\r\n    };\r\n    let resultPass = (rule, value, callback) => {\r\n      if (value === \"\") {\r\n        callback(new Error(\"请输入密码\"));\r\n      } else if (value != this.ruleFormPass.newPass) {\r\n        callback(new Error(\"与之前密码不相符合\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    return {\r\n      activeName: \"third\",\r\n      imageUrl: \"\",\r\n      inputType: \"password\",\r\n      ruleForm: {\r\n        userName: \"\",\r\n      },\r\n      ruleFormPass: {\r\n        originPass: \"\",\r\n        newPass: \"\",\r\n        resultPass: \"\",\r\n      },\r\n      rules: {\r\n        userName: [{ validator: validateuserName, trigger: \"blur\" }],\r\n      },\r\n      rulesPass: {\r\n        originPass: [{ validator: validateoriginPass, trigger: \"blur\" }],\r\n        newPass: [{ validator: validatenewPass, trigger: \"blur\" }],\r\n        resultPass: [{ validator: resultPass, trigger: \"blur\" }],\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    userInfo() {\r\n      return this.$store.state.userInfo;\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapMutations({ changeInfo: \"CHNAGEUSERINFO\" }),\r\n    // 修改用户名\r\n    handlerClick(formName) {\r\n      this.$refs[formName].validate(async (valid) => {\r\n        if (!valid) return;\r\n        if (this.userInfo.userName == this.ruleForm.userName) return;\r\n        const { data: res } = await this.$http.post(\"/blog/changeuser\", {\r\n          userName: this.ruleForm.userName,\r\n          id: this.userInfo._id,\r\n        });\r\n        if (res.code !== 200) return this.$message.error(\"修改失败！\");\r\n        this.changeInfo(res.data);\r\n        this.$message.success(res.value);\r\n        this.$refs.ruleForm.resetFields();\r\n      });\r\n    },\r\n    // 修改密码\r\n    submitForm(ruleForm) {\r\n      this.$refs[ruleForm].validate(async (valid) => {\r\n        if (!valid) return;\r\n        const { data: res } = await this.$http.post(\"/blog/changepass\", {\r\n          userPass: this.ruleFormPass.resultPass,\r\n          id: this.userInfo._id,\r\n        });\r\n        if (res.code !== 200) return this.$message.error(\"修改失败！\");\r\n        this.changeInfo(res.data);\r\n        this.$message.success(res.value);\r\n        this.$refs.ruleFormPass.resetFields();\r\n      });\r\n    },\r\n    // 修改头像\r\n    handleAvatarSuccess(res, file) {    // 上传成功之后触发\r\n      this.imageUrl = URL.createObjectURL(file.raw);\r\n      this.changeInfo(res.data)\r\n      this.$message.success(\"修改成功\")\r\n    },\r\n    beforeAvatarUpload(file) {   // 上传之前触发\r\n      const isJPG = file.type === \"image/jpeg\";\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n      if (!isJPG) {\r\n        this.$message.error(\"上传头像图片只能是 JPG 格式!\");\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Information.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Information.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Information.vue?vue&type=template&id=0cef378a&scoped=true&\"\nimport script from \"./Information.vue?vue&type=script&lang=js&\"\nexport * from \"./Information.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Information.vue?vue&type=style&index=0&id=0cef378a&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0cef378a\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Information.vue?vue&type=style&index=0&id=0cef378a&lang=less&scoped=true&\""],"sourceRoot":""}